<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#0d1117" />
  <title>DevConsole Liquid</title>
  <style>
    :root {
      --glass: rgba(255, 255, 255, 0.05);
      --glass-border: rgba(255, 255, 255, 0.1);
      --accent: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
      --bg-dark: #0d1117;
    }

    body {
      margin: 0; font-family: -apple-system, sans-serif;
      background: var(--bg-dark); color: #fff;
      overflow: hidden; height: 100vh;
    }

    /* Background Animation */
    .bg-blobs {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
      background: radial-gradient(circle at 10% 20%, #1a2a6c, #b21f1f 50%, #fdbb2d);
      opacity: 0.3; filter: blur(80px);
    }

    header {
      padding: calc(env(safe-area-inset-top) + 12px) 20px 12px;
      backdrop-filter: blur(20px); background: var(--glass);
      border-bottom: 1px solid var(--glass-border);
      display: flex; justify-content: space-between; align-items: center;
    }

    h1 { font-size: 18px; margin: 0; background: var(--accent); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

    .main-layout { display: flex; flex-direction: column; height: calc(100vh - 100px); }

    /* Editor */
    #editor {
      flex: 1; width: 100%; background: transparent; border: none;
      color: #9cdcfe; font-family: "SF Mono", monospace; font-size: 14px;
      padding: 20px; outline: none; resize: none;
    }

    /* Quick Toolbar */
    .toolbar {
      display: flex; overflow-x: auto; padding: 10px; gap: 8px;
      background: var(--glass); backdrop-filter: blur(10px);
      border-top: 1px solid var(--glass-border);
    }

    .tool-btn {
      padding: 8px 12px; background: rgba(255,255,255,0.1); border-radius: 8px;
      border: 1px solid var(--glass-border); color: white; font-size: 12px;
    }

    /* Actions Bar */
    .actions {
      padding: 16px; display: flex; gap: 10px;
      background: rgba(0,0,0,0.5);
    }

    .btn {
      flex: 1; padding: 12px; border-radius: 12px; border: none;
      font-weight: bold; color: white; cursor: pointer; transition: 0.2s;
    }

    .btn-run { background: var(--accent); }
    .btn-clear { background: rgba(255,255,255,0.1); }

    /* Fullscreen Preview Overlay */
    #previewOverlay {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: white; z-index: 1000; transform: translateY(100%);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    #previewOverlay.show { transform: translateY(0); }

    .close-preview {
      position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
      background: rgba(0,0,0,0.8); color: white; padding: 12px 24px;
      border-radius: 30px; z-index: 1001; border: 1px solid rgba(255,255,255,0.2);
    }
  </style>
</head>
<body>
  <div class="bg-blobs"></div>
  <header>
    <h1>LiquidConsole</h1>
    <div id="saveStatus" style="font-size: 10px; opacity: 0.5;">Saved</div>
  </header>

  <div class="main-layout">
    <textarea id="editor" spellcheck="false" placeholder="Write HTML/JS here..."></textarea>
    
    <div class="toolbar" id="quickInput">
      </div>

    <div class="actions">
      <button class="btn btn-clear" onclick="clearEditor()">Clear</button>
      <button class="btn btn-run" onclick="openPreview()">Run Preview</button>
    </div>
  </div>

  <div id="previewOverlay">
    <iframe id="previewFrame" style="width:100%; height:100%; border:none;"></iframe>
    <button class="close-preview" onclick="closePreview()">Close Preview</button>
  </div>

  <script>
    const editor = document.getElementById('editor');
    const STORAGE_KEY = 'dev_console_code';

    // LocalStorage: Load
    window.onload = () => {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) editor.value = saved;
      renderQuickTools();
    };

    // LocalStorage: Auto-Save
    editor.addEventListener('input', () => {
      localStorage.setItem(STORAGE_KEY, editor.value);
      showStatus();
    });

    function showStatus() {
      const st = document.getElementById('saveStatus');
      st.textContent = 'Saving...';
      setTimeout(() => st.textContent = 'Saved', 800);
    }

    function clearEditor() {
      if(confirm('Clear all code?')) {
        editor.value = '';
        localStorage.removeItem(STORAGE_KEY);
      }
    }

    // Quick Input Tools
    const tools = ['<', '>', '/', '{', '}', '(', ')', '"', "'", ';', '=', '!'];
    function renderQuickTools() {
      const container = document.getElementById('quickInput');
      tools.forEach(char => {
        const btn = document.createElement('button');
        btn.className = 'tool-btn';
        btn.textContent = char;
        btn.onclick = () => insertAtCursor(char);
        container.appendChild(btn);
      });
    }

    function insertAtCursor(text) {
      const start = editor.selectionStart;
      const end = editor.selectionEnd;
      editor.value = editor.value.substring(0, start) + text + editor.value.substring(end);
      editor.selectionStart = editor.selectionEnd = start + text.length;
      editor.focus();
    }

    // Preview Logic
    function openPreview() {
      const frame = document.getElementById('previewFrame');
      const overlay = document.getElementById('previewOverlay');
      frame.srcdoc = editor.value;
      overlay.classList.add('show');
    }

    function closePreview() {
      document.getElementById('previewOverlay').classList.remove('show');
    }
  </script>
</body>
</html>